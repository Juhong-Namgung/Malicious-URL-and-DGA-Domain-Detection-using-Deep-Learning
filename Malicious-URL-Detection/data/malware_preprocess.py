import pandas as pd
from sklearn.utils import shuffle

df_malware = pd.read_csv("./malware/url_haus_only_url.txt", delimiter='\n', header=None)

malware_labels = []
malware_labels_str = []
malware_urls = []
df_malware_to_list = df_malware[0].tolist()
z = 0

for x in df_malware[0].tolist():
    if len(df_malware_to_list[z]) < 101:
        malware_labels.append(1)
        malware_labels_str.append('malware')
        malware_urls.append(df_malware_to_list[z])
    z = z + 1

# Data columns("url", "label", "class")
malware_archive = pd.DataFrame(columns=['url'])
malware_archive['url'] = malware_urls
malware_archive['label'] = malware_labels_str
malware_archive['class'] = malware_labels

malware_archive.to_csv("./malware_label.csv", mode='w', index=False)

print(malware_archive)